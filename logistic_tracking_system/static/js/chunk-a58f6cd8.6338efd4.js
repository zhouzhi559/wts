(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a58f6cd8"],{5452:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"formDiv"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"数据表名称"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.listQuery.table_name,callback:function(t){e.$set(e.listQuery,"table_name",t)},expression:"listQuery.table_name"}})],1),a("el-form-item",{attrs:{label:"工站"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.listQuery.work_code,callback:function(t){e.$set(e.listQuery,"work_code",t)},expression:"listQuery.work_code"}})],1),a("el-form-item",{staticStyle:{"margin-left":"20px !important"}},[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.searchBtn}},[e._v("查询")]),a("el-button",{attrs:{size:"medium"},on:{click:function(t){return e.resetForm()}}},[e._v("重置")])],1)],1)],1),a("el-card",{staticClass:"box-card mt20"},[a("div",{},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"medium",plain:""},on:{click:e.addBtn}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 新增表")])],1)],1),a("ELTable",{attrs:{tableCol:e.tableCol,tableData:e.tableData,listQuery:e.listQuery,ispagination:e.ispagination},on:{currentChange:e.currentChange,sizeChange:e.sizeChange}})],1)]),a("el-dialog",{attrs:{title:e.dialogTitle,width:"1000px",visible:e.dialogFlag,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFlag=t}}},[a("el-form",{ref:"dialogFormRef",staticStyle:{padding:"0 60px 0 20px"},attrs:{model:e.dialogForm,rules:e.dialogFormRules,"label-width":"100px"}},[a("el-row",[a("div",[a("p",{staticClass:"dialog-title"},[e._v("基本信息")]),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"表名称",prop:"table_name"}},["新增数据表"==e.dialogTitle?a("el-input",{model:{value:e.dialogForm.table_name,callback:function(t){e.$set(e.dialogForm,"table_name",t)},expression:"dialogForm.table_name"}}):a("span",[e._v(e._s(e.dialogForm.table_name))])],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"工站",prop:"work_code"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.dialogForm.work_code,callback:function(t){e.$set(e.dialogForm,"work_code",t)},expression:"dialogForm.work_code"}},e._l(e.WorkCodeNameList,(function(e,t){return a("el-option",{key:t+" dialogForm",attrs:{label:e.work_id+"_"+e.work_name,value:e.work_code}})})),1)],1)],1)],1),a("el-form-item",{attrs:{label:"备注",prop:"description"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.dialogForm.description,callback:function(t){e.$set(e.dialogForm,"description",t)},expression:"dialogForm.description"}})],1)],1),a("div",[a("p",{staticClass:"dialog-title"},[e._v("字段明细")]),a("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return e.AddListRow()}}},[e._v("添加字段")]),a("el-table",{staticClass:"dialogTable",staticStyle:{width:"100%"},attrs:{data:e.dialogForm.response_datas,height:"350"}},[a("el-table-column",{attrs:{fixed:"left",label:"字段名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",{attrs:{prop:"response_datas."+t.$index+".field_name",rules:[{required:!0,message:"字段名称不能为空"}]}},[a("el-input",{model:{value:t.row.field_name,callback:function(a){e.$set(t.row,"field_name",a)},expression:"scope.row.field_name"}})],1)]}}])}),a("el-table-column",{attrs:{label:"字段类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",{attrs:{prop:"response_datas."+t.$index+".field_type",rules:[{required:!0,message:"类型不能为空"}]}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.row.field_type,callback:function(a){e.$set(t.row,"field_type",a)},expression:"scope.row.field_type"}},[a("el-option",{attrs:{label:"整型",value:"INT"}}),a("el-option",{attrs:{label:"浮点型",value:"FLOAT"}}),a("el-option",{attrs:{label:"字符串",value:"VARCHAR"}}),a("el-option",{attrs:{label:"日期",value:"DATETIME"}})],1)],1)]}}])}),a("el-table-column",{attrs:{label:"不可为空",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",{attrs:{prop:"response_datas."+t.$index+".field_NN",rules:[{required:!0,message:"类型不能为空"}]}},[a("el-checkbox",{model:{value:t.row.field_NN,callback:function(a){e.$set(t.row,"field_NN",a)},expression:"scope.row.field_NN"}})],1)]}}])}),a("el-table-column",{attrs:{label:"自增",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"INT"==t.row.field_type,expression:"scope.row.field_type=='INT'"}],attrs:{prop:"response_datas."+t.$index+".field_AI",rules:[{required:!0,message:"类型不能为空"}]}},[a("el-checkbox",{model:{value:t.row.field_AI,callback:function(a){e.$set(t.row,"field_AI",a)},expression:"scope.row.field_AI"}})],1)]}}])}),a("el-table-column",{attrs:{label:"操作",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",[a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])],1)]}}])})],1)],1)])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFlag=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.dialogSave}},[e._v("确 定")])],1)],1)],1)},l=[],o=a("5530"),r=(a("159b"),a("a4d3"),a("e01a"),a("a434"),a("a927")),s=a("fd03"),n=(a("4328"),a("2f62")),c={name:"ProjectBOM",components:{ELTable:r["a"]},computed:Object(o["a"])({},Object(n["c"])(["CurrentUserInfo","WorkCodeNameList"])),data:function(){return{listQuery:{table_name:"",work_code:"",page:1,page_size:10,total:0},listQueryBase:{table_name:"",work_code:"",page:1,page_size:10,total:0},ispagination:!0,productIdReadonly:!1,dialogTitle:"",dialogFlag:!1,radio:0,dialogForm:{table_code:"",table_name:"",work_code:"",description:"",response_datas:[{field_name:"",field_type:"",field_PK:!1,field_NN:!1,field_AI:!1}]},dialogFormBase:{table_code:"",table_name:"",work_code:"",description:"",response_datas:[{field_name:"",field_type:"",field_PK:!1,field_NN:!1,field_AI:!1}]},dialogFormRules:{table_name:[{required:!0,message:"请输入数据表编码",trigger:"blur"},{min:3,max:18,message:"长度为3~18个字节!",trigger:"blur"},{trigger:"blur",validator:function(e,t,a){var i=/^[a-zA-Z0-9-_]+$/;console.log(i.test(t)),i.test(t)?a():a(new Error("仅允许大小写字母和 '-' '_' !"))}}],work_code:[{required:!0,message:"请选择工站",trigger:"change"}]},colDeleteBtnFlag:!1,tableCol:[{label:"数据表名称",field:"table_name",align:"center"},{label:"工站名称",field:"work_name",align:"center"},{label:"备注",field:"description",align:"center"},{label:"创建时间",field:"create_time",align:"center"},{label:"操作",colType:"solt",align:"center",option:[{label:"修改",event:this.colEditBtn},{label:"删除",event:this.colDeleteBtn}]}],tableData:[]}},methods:Object(o["a"])(Object(o["a"])({},Object(n["b"])(["getLogisticWorkCodeName"])),{},{searchBtn:function(){this.listQuery.page=1,this.getLogisticWorkManage(this.listQuery)},resetForm:function(){this.listQuery=JSON.parse(JSON.stringify(this.listQueryBase)),this.getLogisticWorkManage(this.listQuery)},currentChange:function(e){this.listQuery.page=e,this.getLogisticWorkManage(this.listQuery)},sizeChange:function(e){this.listQuery.page=1,this.listQuery.page_size=e,this.getLogisticWorkManage(this.listQuery)},getLogisticWorkManage:function(e){var t=this;s["a"].getLogisticWorkManage(e).then((function(e){if(console.log("数据表结构 查询",e),0==e.code){var a=e.data.data;a.forEach((function(e){t.WorkCodeNameList.forEach((function(t){e.work_code==t.work_code&&(e.work_name=t.work_id+"_"+t.work_name)}))})),t.tableData=a,t.listQuery.total=e.data.total}else t.$message({message:e.message,type:"error"})}))},postLogisticWorkManage:function(e){var t=this;s["a"].postLogisticWorkManage(e).then((function(e){console.log("数据表结构 新增",e),0==e.code?(t.dialogFlag=!1,t.getLogisticWorkManage(t.listQuery),t.$message({message:e.message,type:"success"})):t.$message({message:e.message,type:"error"})}))},colEditBtn:function(e){var t=this;console.log(e),this.dialogTitle="修改数据表",this.dialogFlag=!0,this.productIdReadonly=!0,this.$nextTick((function(){t.$refs.dialogFormRef.clearValidate()})),this.dialogForm=JSON.parse(JSON.stringify(this.dialogFormBase));var a=JSON.parse(JSON.stringify(e.response_datas));a.forEach((function(e){"True"==e.field_PK?e.field_PK=!0:e.field_PK=!1,"True"==e.field_NN?e.field_NN=!0:e.field_NN=!1,"True"==e.field_AI?e.field_AI=!0:e.field_AI=!1})),this.dialogForm={table_code:e.table_code,table_name:e.table_name,work_code:e.work_code,description:e.description,response_datas:a}},getLogisticPutWorkManage:function(e){var t=this;s["a"].getLogisticPutWorkManage(e).then((function(e){console.log("修改数据表 修改",e),0==e.code?(t.getLogisticWorkManage(t.listQuery),t.$message({message:e.message,type:"success"})):t.$message({message:e.message,type:"error"})}))},addBtn:function(){var e=this;this.dialogTitle="新增数据表",this.dialogFlag=!0,this.productIdReadonly=!1,this.$nextTick((function(){e.$refs.dialogFormRef.clearValidate()})),this.dialogForm=JSON.parse(JSON.stringify(this.dialogFormBase))},AddListRow:function(){this.dialogForm.response_datas.push({field_name:"",field_type:"",field_PK:!1,field_NN:!1,field_AI:!1})},dialogSave:function(){var e=this;this.dialogForm.response_datas[this.radio].field_PK=!0,console.log("123123123123213",this.dialogForm),this.$refs.dialogFormRef.validate((function(t){if(t)if("新增数据表"==e.dialogTitle)console.log("新增数据表",e.dialogForm),e.postLogisticWorkManage(e.dialogForm);else{var a=JSON.parse(JSON.stringify(e.dialogForm));a.response_datas.forEach((function(e){e.field_PK?e.field_PK="True":e.field_PK="False",e.field_NN?e.field_NN="True":e.field_NN="False",e.field_AI?e.field_AI="True":e.field_AI="False"})),a.response_datas=JSON.stringify(a.response_datas),console.log("修改数据表",a),e.getLogisticPutWorkManage(a)}else e.$message({message:"请修改正确的数据格式！",type:"warning"})}))},getLogisticDeleteWorkManage:function(e){var t=this;s["a"].getLogisticDeleteWorkManage(e).then((function(e){console.log("数据表结构 删除",e),0==e.code?(t.getLogisticWorkManage(t.listQuery),t.$message({message:e.message,type:"success"})):t.$message({message:e.message,type:"error"})}))},handleDelete:function(e,t){var a=this;t.bom_matter_code?this.$confirm("确定执行删除操作吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i={prodect_code:t.prodect_code,response_datas:JSON.stringify([{field_code:t.field_code}])};a.getLogisticDeleteWorkManage(i),a.dialogForm.response_datas.splice(e,1)})):this.dialogForm.response_datas.splice(e,1)},colDeleteBtn:function(e){var t=this;this.$confirm("确定执行删除操作吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={table_code:e.table_code,response_datas:JSON.stringify([])};t.getLogisticDeleteWorkManage(a)}))}}),mounted:function(){console.log("当前登陆人的接口 数据表结构",this.CurrentUserInfo),this.getLogisticWorkCodeName(),this.getLogisticWorkManage(this.listQuery)}},d=c,g=(a("d508"),a("2877")),u=Object(g["a"])(d,i,l,!1,null,"10c13ea3",null);t["default"]=u.exports},7554:function(e,t,a){},a434:function(e,t,a){"use strict";var i=a("23e7"),l=a("23cb"),o=a("a691"),r=a("50c4"),s=a("7b0b"),n=a("65f0"),c=a("8418"),d=a("1dde"),g=d("splice"),u=Math.max,f=Math.min,p=9007199254740991,m="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!g},{splice:function(e,t){var a,i,d,g,_,h,b=s(this),y=r(b.length),k=l(e,y),w=arguments.length;if(0===w?a=i=0:1===w?(a=0,i=y-k):(a=w-2,i=f(u(o(t),0),y-k)),y+a-i>p)throw TypeError(m);for(d=n(b,i),g=0;g<i;g++)_=k+g,_ in b&&c(d,g,b[_]);if(d.length=i,a<i){for(g=k;g<y-i;g++)_=g+i,h=g+a,_ in b?b[h]=b[_]:delete b[h];for(g=y;g>y-i+a;g--)delete b[g-1]}else if(a>i)for(g=y-i;g>k;g--)_=g+i-1,h=g+a-1,_ in b?b[h]=b[_]:delete b[h];for(g=0;g<a;g++)b[g+k]=arguments[g+2];return b.length=y-i+a,d}})},a927:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-style":{background:"#eef1f6",color:"#606266"}},on:{"selection-change":e.handleSelectionChange}},[e.isShowSelect?a("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._l(e.tableCol,(function(t,i){return["solt"==t.colType?a("el-table-column",{key:i+"only",attrs:{prop:t.field,label:t.label,width:t.width,align:t.align?t.align:"left"},scopedSlots:e._u([{key:"default",fn:function(i){return!t.isShow||t.isShow(i.row)?e._l(t.option,(function(t,l){return a("span",{key:l+"only",staticStyle:{display:"inline-block","margin-left":"5px"}},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.event(i.row)}}},[e._v(" "+e._s(t.label)+" ")])],1)})):void 0}}],null,!0)}):e._e(),"tag"==t.colType?a("el-table-column",{key:i+"only",attrs:{prop:t.field,label:t.label,width:t.width,align:t.align,sortable:""},scopedSlots:e._u([{key:"default",fn:function(i){return[a("el-tag",{style:[{width:t.tagRender(i.row).tagWidth?t.tagRender(i.row).tagWidth:"70px"}],attrs:{size:"medium",type:t.tagRender(i.row).tagType}},[e._v(e._s(t.tagRender(i.row).tagText))])]}}],null,!0)}):e._e(),"solt"!=t.colType&&"tag"!=t.colType&&0!=t.show?a("el-table-column",{key:i+"only",attrs:{prop:t.field,label:t.label,width:t.width,align:t.align,sortable:""}}):e._e()]}))],2),e.ispagination?a("div",{staticClass:"pagination-wrap"},[a("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-sizes":[5,10,20,30,40,50,100],"page-size":e.listQuery.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.listQuery.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()],1)},l=[],o={name:"ELTable",props:{tableCol:{type:Array,default:function(){return[]}},tableData:{type:Array,default:function(){return[]}},ispagination:{type:Boolean,default:!0},isShowSelect:{type:Boolean,default:!1},listQuery:{type:Object,default:function(){return{page:1,page_size:10,total:0}}}},data:function(){return{}},methods:{handleSizeChange:function(e){this.$emit("sizeChange",e)},handleCurrentChange:function(e){this.$emit("currentChange",e)},handleSelectionChange:function(e){this.$emit("handleSelectionChange",e)}}},r=o,s=a("2877"),n=Object(s["a"])(r,i,l,!1,null,"b575f792",null);t["a"]=n.exports},d508:function(e,t,a){"use strict";a("7554")},e01a:function(e,t,a){"use strict";var i=a("23e7"),l=a("83ab"),o=a("da84"),r=a("5135"),s=a("861d"),n=a("9bf2").f,c=a("e893"),d=o.Symbol;if(l&&"function"==typeof d&&(!("description"in d.prototype)||void 0!==d().description)){var g={},u=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof u?new d(e):void 0===e?d():d(e);return""===e&&(g[t]=!0),t};c(u,d);var f=u.prototype=d.prototype;f.constructor=u;var p=f.toString,m="Symbol(test)"==String(d("test")),_=/^Symbol\((.*)\)[^)]+$/;n(f,"description",{configurable:!0,get:function(){var e=s(this)?this.valueOf():this,t=p.call(e);if(r(g,e))return"";var a=m?t.slice(7,-1):t.replace(_,"$1");return""===a?void 0:a}}),i({global:!0,forced:!0},{Symbol:u})}}}]);
//# sourceMappingURL=chunk-a58f6cd8.6338efd4.js.map