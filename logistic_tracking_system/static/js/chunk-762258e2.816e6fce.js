(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-762258e2"],{2994:function(e,t,a){},"98c5":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"formDiv"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"产品名称"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.listQuery.product_name,callback:function(t){e.$set(e.listQuery,"product_name",t)},expression:"listQuery.product_name"}})],1),a("el-form-item",{attrs:{label:"规格型号"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:e.listQuery.rule,callback:function(t){e.$set(e.listQuery,"rule",t)},expression:"listQuery.rule"}})],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.listQuery.product_status,callback:function(t){e.$set(e.listQuery,"product_status",t)},expression:"listQuery.product_status"}},[a("el-option",{attrs:{label:"启用",value:"启用"}}),a("el-option",{attrs:{label:"禁用",value:"禁用"}})],1)],1),a("el-form-item",{staticStyle:{"margin-left":"20px !important"}},[a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.searchBtn}},[e._v("查询")]),a("el-button",{attrs:{size:"medium"},on:{click:function(t){return e.resetForm()}}},[e._v("重置")])],1)],1)],1),a("el-card",{staticClass:"box-card mt20"},[a("div",{},["db_common"==e.CurrentUserInfo.product_id?a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"medium",plain:""},on:{click:e.addBtn}},[a("i",{staticClass:"el-icon-plus"}),e._v(" 新增")])],1)],1):e._e(),a("ELTable",{attrs:{tableCol:e.tableCol,tableData:e.tableData,listQuery:e.listQuery,ispagination:e.ispagination},on:{currentChange:e.currentChange,sizeChange:e.sizeChange}})],1)]),a("el-dialog",{attrs:{title:e.dialogTitle,width:"1000px",visible:e.dialogFlag,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFlag=t}}},[a("el-form",{ref:"dialogFormRef",staticStyle:{padding:"0 60px 0 20px"},attrs:{model:e.dialogForm,rules:e.dialogFormRules,"label-width":"100px"}},[a("el-row",["db_common"==e.CurrentUserInfo.product_id?a("div",[a("p",{staticClass:"dialog-title"},[e._v("基本信息")]),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"产品名称",prop:"product_name"}},[a("el-input",{model:{value:e.dialogForm.product_name,callback:function(t){e.$set(e.dialogForm,"product_name",t)},expression:"dialogForm.product_name"}})],1),a("el-form-item",{attrs:{label:"状态",prop:"product_status"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.dialogForm.product_status,callback:function(t){e.$set(e.dialogForm,"product_status",t)},expression:"dialogForm.product_status"}},[a("el-option",{attrs:{label:"启用",value:"启用"}}),a("el-option",{attrs:{label:"禁用",value:"禁用"}})],1)],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"产品编码",prop:"product_id"}},[a("el-input",{attrs:{readonly:e.productIdReadonly},model:{value:e.dialogForm.product_id,callback:function(t){e.$set(e.dialogForm,"product_id",t)},expression:"dialogForm.product_id"}})],1),a("el-form-item",{attrs:{label:"规格型号",prop:"rule"}},[a("el-input",{model:{value:e.dialogForm.rule,callback:function(t){e.$set(e.dialogForm,"rule",t)},expression:"dialogForm.rule"}})],1)],1)],1),a("el-form-item",{attrs:{label:"备注",prop:"description"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.dialogForm.description,callback:function(t){e.$set(e.dialogForm,"description",t)},expression:"dialogForm.description"}})],1)],1):a("div",[a("p",{staticClass:"dialog-title"},[e._v("物料明细")]),a("el-button",{attrs:{type:"primary",size:"small",plain:""},on:{click:function(t){return e.AddListRow()}}},[e._v("添加物料")]),a("el-table",{staticClass:"dialogTable",staticStyle:{width:"100%"},attrs:{data:e.dialogForm.response_datas,height:"350"}},[a("el-table-column",{attrs:{fixed:"left",label:"物料名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",{attrs:{prop:"response_datas."+t.$index+".matter_name",rules:[{required:!0,message:"物料名称不能为空"}]}},[a("el-input",{model:{value:t.row.matter_name,callback:function(a){e.$set(t.row,"matter_name",a)},expression:"scope.row.matter_name"}})],1)]}}])}),a("el-table-column",{attrs:{label:"规格型号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",{attrs:{prop:"response_datas."+t.$index+".rule",rules:[{required:!0,message:"规格型号不能为空"}]}},[a("el-input",{model:{value:t.row.rule,callback:function(a){e.$set(t.row,"rule",a)},expression:"scope.row.rule"}})],1)]}}])}),a("el-table-column",{attrs:{label:"编码长度",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",{attrs:{prop:"response_datas."+t.$index+".code_length",rules:[{required:!0,message:"编码长度不能为空"},{type:"number",message:"编码长度必须为数值"}]}},[a("el-input",{model:{value:t.row.code_length,callback:function(a){e.$set(t.row,"code_length",e._n(a))},expression:"scope.row.code_length"}})],1)]}}])}),a("el-table-column",{attrs:{label:"类型",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",{attrs:{prop:"response_datas."+t.$index+".matter_category",rules:[{required:!0,message:"类型不能为空"}]}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.row.matter_category,callback:function(a){e.$set(t.row,"matter_category",a)},expression:"scope.row.matter_category"}},[a("el-option",{attrs:{label:"A类",value:"A类"}}),a("el-option",{attrs:{label:"B类",value:"B类"}}),a("el-option",{attrs:{label:"其他",value:"其他"}})],1)],1)]}}])}),a("el-table-column",{attrs:{label:"BOM用量",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",{attrs:{prop:"response_datas."+t.$index+".matter_usage",rules:[{required:!0,message:"数量不能为空"},{type:"number",message:"数量必须为数值"}]}},[a("el-input",{model:{value:t.row.matter_usage,callback:function(a){e.$set(t.row,"matter_usage",e._n(a))},expression:"scope.row.matter_usage"}})],1)]}}])}),a("el-table-column",{attrs:{label:"操作",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form-item",[a("el-button",{attrs:{size:"small",type:"danger",plain:""},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])],1)]}}])})],1)],1)])],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFlag=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.dialogSave}},[e._v("确 定")])],1)],1)],1)},l=[],i=a("5530"),r=(a("159b"),a("a434"),a("a4d3"),a("e01a"),a("a927")),s=a("fd03"),n=(a("4328"),a("2f62")),c={name:"ProjectBOM",components:{ELTable:r["a"]},computed:Object(i["a"])({},Object(n["c"])(["CurrentUserInfo"])),data:function(){return{listQuery:{product_name:"",rule:"",product_status:"",page:1,page_size:10,total:0},listQueryBase:{product_name:"",rule:"",product_status:"",page:1,page_size:10,total:0},ispagination:!0,productIdReadonly:!1,dialogTitle:"",dialogFlag:!1,dialogForm:{prodect_code:"",product_name:"",product_id:"",rule:"",product_status:"",description:"",response_datas:[]},dialogFormBase:{prodect_code:"",product_name:"",product_id:"",rule:"",product_status:"",description:"",response_datas:[]},dialogFormRules:{product_name:[{required:!0,message:"请输入产品名称",trigger:"blur"}],product_id:[{required:!0,message:"请输入产品编码",trigger:"blur"},{min:3,max:18,message:"长度为3~18个字节!",trigger:"blur"},{trigger:"blur",validator:function(e,t,a){var o=/^[a-z0-9]+$/;console.log(o.test(t)),o.test(t)?a():a(new Error("仅允许小写字母和数字!"))}}]},colDeleteBtnFlag:!1,tableCol:[{label:"产品名称",field:"product_name",align:"center"},{label:"产品编码",field:"product_id",align:"center"},{label:"规格型号",field:"rule",align:"center"},{label:"状态",field:"product_status",align:"center",colType:"tag",tagRender:function(e){var t={tagType:"",tagText:e.product_status};return"启用"==e.product_status?t.tagType="":t.tagType="warning",t}},{label:"备注",field:"description",align:"center"}],tableData:[]}},methods:{searchBtn:function(){this.listQuery.page=1,this.getLogisticBOMProductList(this.listQuery)},resetForm:function(){this.listQuery=JSON.parse(JSON.stringify(this.listQueryBase)),this.getLogisticBOMProductList(this.listQuery)},currentChange:function(e){this.listQuery.page=e,this.getLogisticBOMProductList(this.listQuery)},sizeChange:function(e){this.listQuery.page=1,this.listQuery.page_size=e,this.getLogisticBOMProductList(this.listQuery)},getLogisticBOMProductList:function(e){var t=this;s["a"].getLogisticBOMProductList(e).then((function(e){console.log("产品结构 查询",e),0==e.code?(t.tableData=e.data.data,t.listQuery.total=e.data.total):t.$message({message:e.message,type:"error"})}))},postLogisticBOMProductList:function(e){var t=this;s["a"].postLogisticBOMProductList(e).then((function(e){console.log("产品结构 新增",e),0==e.code?(t.dialogFlag=!1,t.getLogisticBOMProductList(t.listQuery),t.$message({message:e.message,type:"success"})):t.$message({message:e.message,type:"error"})}))},colEditBtn:function(e){var t=this;console.log(e),this.dialogTitle="修改产品",this.dialogFlag=!0,this.productIdReadonly=!0,this.$nextTick((function(){t.$refs.dialogFormRef.clearValidate()})),this.dialogForm=JSON.parse(JSON.stringify(this.dialogFormBase)),e.response_datas?e.response_datas.forEach((function(t,a){t.bom_matter_code||e.response_datas.splice(a,1)})):e.response_datas=[],this.dialogForm={prodect_code:e.prodect_code,product_id:e.product_id,product_name:e.product_name,rule:e.rule,product_status:e.product_status,description:e.description,response_datas:e.response_datas}},getLogisticPutBOMProductList:function(e){var t=this;s["a"].getLogisticPutBOMProductList(e).then((function(e){console.log("修改产品 修改",e),0==e.code?(t.getLogisticBOMProductList(t.listQuery),t.$message({message:e.message,type:"success"})):t.$message({message:e.message,type:"error"})}))},addBtn:function(){var e=this;this.dialogTitle="新增产品",this.dialogFlag=!0,this.productIdReadonly=!1,this.$nextTick((function(){e.$refs.dialogFormRef.clearValidate()})),this.dialogForm=JSON.parse(JSON.stringify(this.dialogFormBase))},AddListRow:function(){this.dialogForm.response_datas.push({matter_name:"",rule:"",matter_category:"",matter_usage:""})},dialogSave:function(){var e=this;this.$refs.dialogFormRef.validate((function(t){if(t)if("新增产品"==e.dialogTitle)console.log("新增产品",e.dialogForm),e.postLogisticBOMProductList(e.dialogForm);else{console.log("修改产品",e.dialogForm);var a=JSON.parse(JSON.stringify(e.dialogForm));a.response_datas=JSON.stringify(a.response_datas),e.getLogisticPutBOMProductList(a)}else e.$message({message:"请修改正确的数据格式！",type:"warning"})}))},getLogisticDeleteBOMProductList:function(e){var t=this;s["a"].getLogisticDeleteBOMProductList(e).then((function(e){console.log("产品结构 删除",e),0==e.code?(t.getLogisticBOMProductList(t.listQuery),t.$message({message:e.message,type:"success"})):t.$message({message:e.message,type:"error"})}))},handleDelete:function(e,t){var a=this;t.bom_matter_code?this.$confirm("确定执行删除操作吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var o={prodect_code:t.prodect_code,response_datas:JSON.stringify([{bom_matter_code:t.bom_matter_code}])};a.getLogisticDeleteBOMProductList(o),a.dialogForm.response_datas.splice(e,1)})):this.dialogForm.response_datas.splice(e,1)},colDeleteBtn:function(e){var t=this;this.$confirm("确定执行删除操作吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={prodect_code:e.prodect_code,response_datas:JSON.stringify([])};t.getLogisticDeleteBOMProductList(a)}))}},mounted:function(){console.log("当前登陆人的接口 产品结构",this.CurrentUserInfo),"db_common"==this.CurrentUserInfo.product_id?this.tableCol.push({label:"操作",colType:"solt",align:"center",option:[{label:"修改",event:this.colEditBtn},{label:"删除",event:this.colDeleteBtn}]}):this.tableCol.push({label:"操作",colType:"solt",align:"center",option:[{label:"维护物料",event:this.colEditBtn}]}),console.log("当前登陆人的接口 this.colDeleteBtnFlag",this.colDeleteBtnFlag),this.getLogisticBOMProductList(this.listQuery)}},u=c,d=(a("f6b4a"),a("2877")),p=Object(d["a"])(u,o,l,!1,null,"2dd591c9",null);t["default"]=p.exports},a434:function(e,t,a){"use strict";var o=a("23e7"),l=a("23cb"),i=a("a691"),r=a("50c4"),s=a("7b0b"),n=a("65f0"),c=a("8418"),u=a("1dde"),d=u("splice"),p=Math.max,g=Math.min,m=9007199254740991,f="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var a,o,u,d,h,_,b=s(this),y=r(b.length),v=l(e,y),w=arguments.length;if(0===w?a=o=0:1===w?(a=0,o=y-v):(a=w-2,o=g(p(i(t),0),y-v)),y+a-o>m)throw TypeError(f);for(u=n(b,o),d=0;d<o;d++)h=v+d,h in b&&c(u,d,b[h]);if(u.length=o,a<o){for(d=v;d<y-o;d++)h=d+o,_=d+a,h in b?b[_]=b[h]:delete b[_];for(d=y;d>y-o+a;d--)delete b[d-1]}else if(a>o)for(d=y-o;d>v;d--)h=d+o-1,_=d+a-1,h in b?b[_]=b[h]:delete b[_];for(d=0;d<a;d++)b[d+v]=arguments[d+2];return b.length=y-o+a,u}})},a927:function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-style":{background:"#eef1f6",color:"#606266"}},on:{"selection-change":e.handleSelectionChange}},[e.isShowSelect?a("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._l(e.tableCol,(function(t,o){return["solt"==t.colType?a("el-table-column",{key:o+"only",attrs:{prop:t.field,label:t.label,width:t.width,align:t.align?t.align:"left"},scopedSlots:e._u([{key:"default",fn:function(o){return!t.isShow||t.isShow(o.row)?e._l(t.option,(function(t,l){return a("span",{key:l+"only",staticStyle:{display:"inline-block","margin-left":"5px"}},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.event(o.row)}}},[e._v(" "+e._s(t.label)+" ")])],1)})):void 0}}],null,!0)}):e._e(),"tag"==t.colType?a("el-table-column",{key:o+"only",attrs:{prop:t.field,label:t.label,width:t.width,align:t.align,sortable:""},scopedSlots:e._u([{key:"default",fn:function(o){return[a("el-tag",{style:[{width:t.tagRender(o.row).tagWidth?t.tagRender(o.row).tagWidth:"70px"}],attrs:{size:"medium",type:t.tagRender(o.row).tagType}},[e._v(e._s(t.tagRender(o.row).tagText))])]}}],null,!0)}):e._e(),"solt"!=t.colType&&"tag"!=t.colType&&0!=t.show?a("el-table-column",{key:o+"only",attrs:{prop:t.field,label:t.label,width:t.width,align:t.align,sortable:""}}):e._e()]}))],2),e.ispagination?a("div",{staticClass:"pagination-wrap"},[a("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-sizes":[5,10,20,30,40,50,100],"page-size":e.listQuery.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.listQuery.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()],1)},l=[],i={name:"ELTable",props:{tableCol:{type:Array,default:function(){return[]}},tableData:{type:Array,default:function(){return[]}},ispagination:{type:Boolean,default:!0},isShowSelect:{type:Boolean,default:!1},listQuery:{type:Object,default:function(){return{page:1,page_size:10,total:0}}}},data:function(){return{}},methods:{handleSizeChange:function(e){this.$emit("sizeChange",e)},handleCurrentChange:function(e){this.$emit("currentChange",e)},handleSelectionChange:function(e){this.$emit("handleSelectionChange",e)}}},r=i,s=a("2877"),n=Object(s["a"])(r,o,l,!1,null,"b575f792",null);t["a"]=n.exports},e01a:function(e,t,a){"use strict";var o=a("23e7"),l=a("83ab"),i=a("da84"),r=a("5135"),s=a("861d"),n=a("9bf2").f,c=a("e893"),u=i.Symbol;if(l&&"function"==typeof u&&(!("description"in u.prototype)||void 0!==u().description)){var d={},p=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof p?new u(e):void 0===e?u():u(e);return""===e&&(d[t]=!0),t};c(p,u);var g=p.prototype=u.prototype;g.constructor=p;var m=g.toString,f="Symbol(test)"==String(u("test")),h=/^Symbol\((.*)\)[^)]+$/;n(g,"description",{configurable:!0,get:function(){var e=s(this)?this.valueOf():this,t=m.call(e);if(r(d,e))return"";var a=f?t.slice(7,-1):t.replace(h,"$1");return""===a?void 0:a}}),o({global:!0,forced:!0},{Symbol:p})}},f6b4a:function(e,t,a){"use strict";a("2994")}}]);
//# sourceMappingURL=chunk-762258e2.816e6fce.js.map