(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f2c065de"],{"2f82":function(e,t,o){},5849:function(e,t,o){"use strict";o("2f82")},6726:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-card",[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("CommonMissStationHeader")],1),o("el-form",{ref:"formRef",staticStyle:{padding:"0 60px 0 20px",width:"700px",margin:"20px 0 60px 0"},attrs:{model:e.form,rules:e.formRules,"label-width":"none"}},[o("el-form-item",{attrs:{prop:"finished_product_code",label:"产品编码"}},[o("el-input",{ref:"firstInput",attrs:{clearable:""},on:{input:function(t){return e.inputChange()}},model:{value:e.form.finished_product_code,callback:function(t){e.$set(e.form,"finished_product_code",t)},expression:"form.finished_product_code"}})],1)],1)],1),o("el-card",{staticClass:"box-card mt20"},[o("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[o("span",[e._v("过站信息")])]),o("div",{},[o("ELTable",{attrs:{tableCol:e.tableCol,tableData:e.tableData,listQuery:e.listQuery,ispagination:!0},on:{currentChange:e.currentChange,sizeChange:e.sizeChange}})],1)]),o("el-dialog",{attrs:{title:"不良原因",width:"600px",visible:e.dialogFlagBadInfo},on:{"update:visible":function(t){e.dialogFlagBadInfo=t}}},[o("el-form",{staticStyle:{padding:"0 60px 0 20px"},attrs:{model:e.dialogBadInfoForm,"label-width":"100px"}},[o("el-form-item",{attrs:{label:"不良现象：",prop:"unqualified_result_name"}},[o("span",[e._v(e._s(e.dialogBadInfoForm.unqualified_result_name))])]),o("el-form-item",{attrs:{label:"不良原因：",prop:"content"}},[o("span",[e._v(e._s(e.dialogBadInfoForm.content))])]),o("el-form-item",{attrs:{label:"处理方式：",prop:"process_mode"}},[o("span",[e._v(e._s(e.dialogBadInfoForm.process_mode))])])],1)],1),o("el-dialog",{attrs:{title:e.dialogTitle,width:"1000px",visible:e.dialogFlag,"close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogFlag=t}}},[o("el-form",{ref:"dialogFormRef",staticStyle:{padding:"0 60px 0 20px"},attrs:{model:e.dialogForm,rules:e.dialogFormRules,"label-width":"100px"}},["产品维修"==e.dialogTitle?o("div",[o("el-form-item",{attrs:{label:"产品编码"}},[o("span",[e._v(e._s(e.dialogForm.finished_product_code))])]),o("el-row",{staticClass:"elRow"},[o("el-col",{attrs:{span:4}},[e._v("工站编码")]),o("el-col",{attrs:{span:4}},[e._v("物料名称")]),o("el-col",{attrs:{span:12}},[e._v("物料编码")]),o("el-col",{attrs:{span:4}},[e._v("操作")])],1),o("el-divider"),e._l(e.dialogForm.response_datas,(function(t,a){return o("div",{key:a+" onlyItem"},[o("el-row",{staticClass:"elRow"},[o("el-col",{attrs:{span:4}},[e._v(e._s(t.work_id))]),o("el-col",{attrs:{span:4}},[e._v(e._s(t.matter_name))]),o("el-col",{attrs:{span:12}},[e.vOnceFlag?e._o(o("span",[e._v(e._s(t.matter_id))]),0,a+" onlyItem"):o("span",[e._v(e._s(t.matter_id))])]),o("el-col",{attrs:{span:4}},[o("span",{staticStyle:{color:"#409eff",cursor:"pointer"},on:{click:function(o){return e.editMatter(t,a)}}},[e._v(" 修改")])])],1),o("el-row",{staticClass:"elRow"},[o("el-col",{attrs:{span:4}}),o("el-col",{attrs:{span:4}}),o("el-col",{attrs:{span:12}},[o("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"item.show"}],attrs:{prop:"response_datas."+a+".matter_id","label-width":"40px",label:"",rules:[{required:!0,message:"物料编码不能为空",trigger:"blur"},{pattern:t.rule,message:"物料编码需要包含"+t.rule,trigger:"blur"},{min:t.code_length,max:t.code_length,message:"物料编码长度为 "+t.code_length+"个字节。",trigger:"blur"}]}},[o("el-input",{ref:"matterInput"+a,refInFor:!0,attrs:{clearable:""},on:{input:function(t){return e.inputMatter(a)}},model:{value:t.matter_id,callback:function(o){e.$set(t,"matter_id",o)},expression:"item.matter_id"}})],1)],1),o("el-col",{attrs:{span:4}})],1),o("el-divider")],1)}))],2):e._e()]),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.dialogFlag=!1}}},[e._v("取 消")]),o("el-button",{attrs:{type:"primary"},on:{click:e.dialogSave}},[e._v("确 定")])],1)],1)],1)},i=[],n=o("5530"),s=(o("a4d3"),o("e01a"),o("159b"),o("fd03")),r=o("2f62"),l=o("e3d2"),d=o("a927"),c={name:"MissStationM",components:{CommonMissStationHeader:l["a"],ELTable:d["a"]},created:function(){window.addEventListener("keydown",this.handleKeyDown,!0)},data:function(){return{dialogFlagBadInfo:!1,dialogFlag:!1,vOnceFlag:!1,timeout:"",unqualifiedData:[],dialogSaveFlag:!0,Package_Qty:"",Shipping_SN_length:"",Product_length:"",finished_product_codeFlag:!1,form:{status:"",product_plan_code:"",finished_product_code:""},formBase:{status:"",product_plan_code:"",finished_product_code:""},formRules:{finished_product_code:[{required:!0,message:"请输入产品编码",trigger:"blur"}]},listQuery:{status:"入站",product_plan_code:this.ProductionPlanCode,page:1,page_size:10,total:0},listQueryBase:{status:"入站",product_plan_code:this.ProductionPlanCode,page:1,page_size:10,total:0},dialogBadInfoForm:{unqualified_result_name:"",content:"",process_mode:""},dialogBadInfoFormBase:{unqualified_result_name:"",content:"",process_mode:""},dialogForm:{modify_in_workstation_code:"",finished_product_code:"",product_plan_code:"",process_method:"",return_work_id:"",status:"",response_datas:[]},dialogFormBase:{modify_in_workstation_code:"",finished_product_code:"",product_plan_code:"",process_method:"",return_work_id:"",status:"",response_datas:[]},ispagination:!0,tableCol:[{label:"生产计划",field:"product_plan_name",align:"center"},{label:"产品编码",field:"finished_product_code",align:"center"},{label:"操作人员",width:"200px",field:"operate_user_name",align:"center"},{label:"处理方式",field:"process_method",align:"center"},{label:"来源工站",field:"enter_work_name",align:"center"},{label:"入站时间",field:"enter_time",align:"center"},{label:"出站时间",field:"out_time",align:"center"},{label:"操作",colType:"solt",align:"center",isShow:function(e){return"入站"==e.status},option:[{label:"不良原因",event:this.colBadInfoBtn},{label:"维修",event:this.colEditBtn},{label:"拆解",event:this.colResetBtn},{label:"出站",event:this.colReturnBtn}]}],tableData:[]}},computed:Object(n["a"])({},Object(r["c"])(["ProductionPlanCode","BomMatterCodeNameList","WorkCodeNameList","ProductPlanCodeNameList","PersonCodeNameList"])),methods:Object(n["a"])(Object(n["a"])({},Object(r["b"])(["getLogisticBomMatterCodeName","getLogisticWorkCodeName","getLogisticProductPlanDeal","getLogisticProductPlanCodeName","getLogisticPersonCodeName"])),{},{operate_type_change:function(){"产品拆解"==this.dialogForm.operate_type?this.dialogForm.response_datas=[]:this.getLogisticFinishedCodeGetMatterCodeID(this.form)},getLogisticOperationSystem:function(){var e=this;s["a"].getLogisticOperationSystem({page:1,page_size:10}).then((function(t){console.log("打印参数列表 查询",t),0==t.code?(e.Package_Qty=t.data.data[0].Package_Qty,e.Shipping_SN_length=t.data.data[0].Shipping_SN_length,e.Product_length=t.data.data[0].Product_length,console.log("this.Package_Qty ",e.Package_Qty)):e.$message({message:t.message,type:"error"})}))},getLogisticProductCodeResponseResult:function(e){var t=this;s["a"].getLogisticProductCodeResponseResult(e).then((function(e){if(console.log("产品码返回一个不良原因编码",e),0==e.code){if(0==e.data.length)return t.$message.warning("没有不良原因！"),!1;t.dialogFlagBadInfo=!0,s["a"].getLogisticWorkUnqualifiedResult({unqualified_result_code:e.data[0].description,page:1,page_size:10}).then((function(e){console.log("工站和不良原因表的接口",e),0==e.code?(t.unqualifiedData=e.data.data,console.log("this.unqualifiedData",t.unqualifiedData),t.dialogBadInfoForm.unqualified_result_name=e.data.data[0].unqualified_result_name,t.dialogBadInfoForm.content=e.data.data[0].content,t.dialogBadInfoForm.process_mode=e.data.data[0].process_mode):t.$message({message:e.message,type:"error"})}))}else t.$message({message:res.message,type:"error"})}))},inputChange:function(e){var t=this;this.timeout&&clearTimeout(this.timeout),this.timeout=setTimeout((function(){if(t.form.finished_product_code.length!=t.Product_length)return t.$message.warning("产品编码长度为"+t.Product_length+"个字节。"),!1;t.form.finished_product_code=t.form.finished_product_code,t.form.product_plan_code=t.ProductionPlanCode,t.form.status="入站";var e=JSON.parse(JSON.stringify(t.form));t.postLogisticModifyInWorkStation(e)}),500)},editMatter:function(e,t){var o=this;e.matter_id="",e.show=!e.show,this.$nextTick((function(){o.$refs["matterInput"+t][0].focus()}))},inputMatter:function(e){var t=this;console.log(this.dialogForm.response_datas[e]),this.timeout=setTimeout((function(){return t.dialogSaveFlag=!0,""==t.dialogForm.response_datas[e].matter_id?(t.$message.warning("物料编码不能为空"),t.dialogSaveFlag=!1,!1):t.dialogForm.response_datas[e].matter_id.indexOf(t.dialogForm.response_datas[e].rule)<0?(t.$message.warning("物料编码需要包含"+t.dialogForm.response_datas[e].rule),t.dialogSaveFlag=!1,!1):t.dialogForm.response_datas[e].matter_id.length!=t.dialogForm.response_datas[e].code_length?(t.$message.warning("物料编码长度为"+t.dialogForm.response_datas[e].code_length+"个字节。"),t.dialogSaveFlag=!1,!1):void 0}),500)},getLogisticFinishedCodeGetMatterCodeID:function(e){var t=this;s["a"].getLogisticFinishedCodeGetMatterCodeID(e).then((function(e){if(console.log("通过产品编码查询物料 查询",e),0==e.code){var o=e.data;o.forEach((function(e,o){t.BomMatterCodeNameList.forEach((function(t){e.matter_code==t.matter_code&&(e.matter_name=t.matter_name,e.rule=t.rule,e.code_length=t.code_length),e.show=t.false}))})),t.dialogForm.response_datas=e.data}else t.$message({message:e.message,type:"error"})}))},getDeleteFinishedCodeGetMatterCodeID:function(e){var t=this;s["a"].getDeleteFinishedCodeGetMatterCodeID(e).then((function(e){console.log("重 置 删除",e),0==e.code?(t.getLogisticModifyInWorkStation(t.listQuery),t.$message({message:e.message,type:"success"})):t.$message({message:e.message,type:"error"})}))},getLogisticPutFinishedCodeGetMatterCodeID:function(e){var t=this;s["a"].getLogisticPutFinishedCodeGetMatterCodeID(e).then((function(e){console.log("产品过站 修改",e),0==e.code?(t.vOnceFlag=!1,t.getLogisticModifyInWorkStation(t.listQuery),t.$message({message:e.message,type:"success"})):t.$message({message:e.message,type:"error"})}))},handleKeyDown:function(e){var t=null;t=void 0===window.event?e.keyCode:window.event.keyCode,13===t&&this.dialogSave()},getLogisticModifyInWorkStation:function(e){var t=this;s["a"].getLogisticModifyInWorkStation(e).then((function(e){if(console.log("过站查询 查询",e),0==e.code){var o=e.data.data;o.forEach((function(e){t.ProductPlanCodeNameList.forEach((function(t){e.product_plan_code==t.product_plan_code&&(e.product_plan_name=t.product_plan_name)})),t.WorkCodeNameList.forEach((function(t){e.enter_work_code==t.work_code&&(e.enter_work_name=t.work_name)})),t.PersonCodeNameList.forEach((function(t){e.operate_user==t.user_code&&(e.operate_user_name=t.user_name)}))})),t.tableData=o,t.vOnceFlag=!0,t.listQuery.total=e.data.total}else t.$message({message:e.message,type:"error"})}))},postLogisticModifyInWorkStation:function(e){var t=this;s["a"].postLogisticModifyInWorkStation(e).then((function(e){console.log("过站 新增",e),0==e.code?(t.dialogForm=JSON.parse(JSON.stringify(t.dialogFormBase)),t.form.finished_product_code="",t.getLogisticModifyInWorkStation(t.listQuery),t.$message({message:e.message,type:"success"})):t.$message({message:e.message,type:"error"})}))},currentChange:function(e){this.listQuery.page=e,this.getLogisticModifyInWorkStation(this.listQuery)},sizeChange:function(e){this.listQuery.page=1,this.listQuery.page_size=e,this.getLogisticModifyInWorkStation(this.listQuery)},colBadInfoBtn:function(e){console.log(e),this.dialogBadInfoForm=JSON.parse(JSON.stringify(this.dialogBadInfoFormBase)),this.getLogisticProductCodeResponseResult({finished_product_code:e.finished_product_code})},colEditBtn:function(e){if(console.log(e),!this.ProductionPlanCode)return this.$message.warning("没有进行中的生产计划！"),!1;this.dialogFlag=!0,this.dialogTitle="产品维修",this.dialogForm.process_method="产品维修",this.dialogForm.status="入站",this.dialogForm.finished_product_code=e.finished_product_code,this.dialogForm.return_work_id=e.enter_work_code,this.dialogForm.modify_in_workstation_code=e.modify_in_workstation_code,this.getLogisticFinishedCodeGetMatterCodeID(this.dialogForm)},colResetBtn:function(e){var t=this;if(console.log(e),!this.ProductionPlanCode)return this.$message.warning("没有进行中的生产计划！"),!1;this.$confirm("确定执行产品拆解操作吗？此操作将解绑所有与该产品绑定的物料。","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.dialogForm.finished_product_code=e.finished_product_code,t.dialogForm.process_method="产品拆解",t.dialogForm.status="入站",t.dialogForm.modify_in_workstation_code=e.modify_in_workstation_code,t.getDeleteFinishedCodeGetMatterCodeID(t.dialogForm)}))},colReturnBtn:function(e){var t=this;if(console.log(e),!this.ProductionPlanCode)return this.$message.warning("没有进行中的生产计划！"),!1;this.dialogForm.process_method="产品出站",this.dialogForm.finished_product_code=e.finished_product_code,this.dialogForm.status="出站",this.dialogForm.enter_work_code=e.enter_work_code,this.dialogForm.return_work_id=e.enter_work_code,this.dialogForm.modify_in_workstation_code=e.modify_in_workstation_code,this.getLogisticFinishedCodeGetMatterCodeID(this.dialogForm),this.$confirm("确定执行出站操作吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){console.log("this.form.response_datas",t.response_datas);var e=JSON.parse(JSON.stringify(t.dialogForm));e.product_plan_code=t.ProductionPlanCode,e.response_datas.forEach((function(e){e.show=""})),e.response_datas=JSON.stringify(e.response_datas),console.log("params params params",e),t.getLogisticPutFinishedCodeGetMatterCodeID(e)}))},dialogSave:function(){var e=this;if(!this.dialogSaveFlag)return this.$message.warning("请输入正确的物料编码！"),!1;this.$refs.dialogFormRef.validate((function(t){t||e.$message({message:"请修改正确的数据格式！",type:"warning"})})),console.log("this.form",this.form);var t=JSON.parse(JSON.stringify(this.dialogForm));t.product_plan_code=this.ProductionPlanCode,t.response_datas.forEach((function(e){e.show=""})),t.response_datas=JSON.stringify(t.response_datas),console.log("params params params",t),this.getLogisticPutFinishedCodeGetMatterCodeID(t)}}),mounted:function(){var e=this;this.getLogisticOperationSystem(),this.getLogisticWorkCodeName(),this.getLogisticProductPlanDeal(),this.getLogisticBomMatterCodeName(),this.getLogisticProductPlanCodeName(),this.getLogisticPersonCodeName(),this.listQuery.product_plan_code=this.ProductionPlanCode,this.getLogisticModifyInWorkStation(this.listQuery),this.$nextTick((function(){e.$refs.firstInput.focus()}))}},g=c,u=(o("6f1b"),o("2877")),p=Object(u["a"])(g,a,i,!1,null,"78a6e7a8",null);t["default"]=p.exports},"6f1b":function(e,t,o){"use strict";o("b781")},a927:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-style":{background:"#eef1f6",color:"#606266"}},on:{"selection-change":e.handleSelectionChange}},[e.isShowSelect?o("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._l(e.tableCol,(function(t,a){return["solt"==t.colType?o("el-table-column",{key:a+"only",attrs:{prop:t.field,label:t.label,width:t.width,align:t.align?t.align:"left"},scopedSlots:e._u([{key:"default",fn:function(a){return!t.isShow||t.isShow(a.row)?e._l(t.option,(function(t,i){return o("span",{key:i+"only",staticStyle:{display:"inline-block","margin-left":"5px"}},[o("el-button",{attrs:{type:"text",size:"small"},on:{click:function(e){return t.event(a.row)}}},[e._v(" "+e._s(t.label)+" ")])],1)})):void 0}}],null,!0)}):e._e(),"tag"==t.colType?o("el-table-column",{key:a+"only",attrs:{prop:t.field,label:t.label,width:t.width,align:t.align,sortable:""},scopedSlots:e._u([{key:"default",fn:function(a){return[o("el-tag",{style:[{width:t.tagRender(a.row).tagWidth?t.tagRender(a.row).tagWidth:"70px"}],attrs:{size:"medium",type:t.tagRender(a.row).tagType}},[e._v(e._s(t.tagRender(a.row).tagText))])]}}],null,!0)}):e._e(),"solt"!=t.colType&&"tag"!=t.colType&&0!=t.show?o("el-table-column",{key:a+"only",attrs:{prop:t.field,label:t.label,width:t.width,align:t.align,sortable:""}}):e._e()]}))],2),e.ispagination?o("div",{staticClass:"pagination-wrap"},[o("el-pagination",{attrs:{"current-page":e.listQuery.page,"page-sizes":[5,10,20,30,40,50,100],"page-size":e.listQuery.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.listQuery.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()],1)},i=[],n={name:"ELTable",props:{tableCol:{type:Array,default:function(){return[]}},tableData:{type:Array,default:function(){return[]}},ispagination:{type:Boolean,default:!0},isShowSelect:{type:Boolean,default:!1},listQuery:{type:Object,default:function(){return{page:1,page_size:10,total:0}}}},data:function(){return{}},methods:{handleSizeChange:function(e){this.$emit("sizeChange",e)},handleCurrentChange:function(e){this.$emit("currentChange",e)},handleSelectionChange:function(e){this.$emit("handleSelectionChange",e)}}},s=n,r=o("2877"),l=Object(r["a"])(s,a,i,!1,null,"b575f792",null);t["a"]=l.exports},b781:function(e,t,o){},e01a:function(e,t,o){"use strict";var a=o("23e7"),i=o("83ab"),n=o("da84"),s=o("5135"),r=o("861d"),l=o("9bf2").f,d=o("e893"),c=n.Symbol;if(i&&"function"==typeof c&&(!("description"in c.prototype)||void 0!==c().description)){var g={},u=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof u?new c(e):void 0===e?c():c(e);return""===e&&(g[t]=!0),t};d(u,c);var p=u.prototype=c.prototype;p.constructor=u;var m=p.toString,_="Symbol(test)"==String(c("test")),f=/^Symbol\((.*)\)[^)]+$/;l(p,"description",{configurable:!0,get:function(){var e=r(this)?this.valueOf():this,t=m.call(e);if(s(g,e))return"";var o=_?t.slice(7,-1):t.replace(f,"$1");return""===o?void 0:o}}),a({global:!0,forced:!0},{Symbol:u})}},e3d2:function(e,t,o){"use strict";var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("span",{staticClass:"boxDivSpanFontSize"},[e._v(" 生产计划 : ")]),o("span",{},[e._v(e._s(e.ProductionPlanName))]),o("span",{staticClass:"ml20 boxDivSpanFontSize"},[e._v(" 工站编码 : ")]),o("span",{},[e._v(e._s(e.CurrentUserInfo.work_id))]),o("span",{staticClass:"ml20 boxDivSpanFontSize"},[e._v("工站名称 : ")]),o("span",[e._v(e._s(e.workStationName))]),o("span",{staticClass:"ml20 boxDivSpanFontSize"},[e._v("工站类型 : ")]),o("span",[e._v(e._s(e.CurrentUserInfo.work_type))])])},i=[],n=o("1da1"),s=o("5530"),r=(o("96cf"),o("159b"),o("fd03")),l=o("2f62"),d={computed:Object(s["a"])({},Object(l["c"])(["WorkCodeNameList","ProductionPlanCode","CurrentUserInfo"])),created:function(){},data:function(){return{workStationName:"",ProductionPlanName:""}},methods:Object(s["a"])(Object(s["a"])({},Object(l["b"])(["getLogisticWorkCodeName","getLogisticProductPlanDeal"])),{},{getMissStationHeaderWorkName:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getLogisticWorkCodeName();case 2:e.WorkCodeNameList.forEach((function(t){e.CurrentUserInfo.work_id==t.work_id&&(e.workStationName=t.work_name)}));case 3:case"end":return t.stop()}}),t)})))()}}),mounted:function(){var e=this;r["a"].getLogisticProductPlanDeal({prodect_code:"",plan_name:"",plan_status:"进行中",page:1,page_size:10,total:0}).then((function(t){0==t.code&&(console.log(111,t),console.log(111,t.data.data[0]),e.ProductionPlanName=t.data.data[0].plan_name)})),this.getMissStationHeaderWorkName()}},c=d,g=(o("5849"),o("2877")),u=Object(g["a"])(c,a,i,!1,null,"602c22a7",null);t["a"]=u.exports}}]);
//# sourceMappingURL=chunk-f2c065de.db3de3ba.js.map